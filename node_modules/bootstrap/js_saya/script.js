// Navbar
var navbar = document.querySelector('nav')
window.addEventListener('scroll', ()=>{
    console.log(window.scrollY)
    if(window.scrollY > 200){
        navbar.classList.replace('bg-trasnparent','nav-color');
    }else if (this.window.scrollY <= 300){
        navbar.classList.replace('nav-color','bg-trasnparent');
    }
});

// AOS Index
const galleryImage = document.querySelectorAll('.img-card');

galleryImage.forEach((img, i) => {
  img.dataset.aos = 'fade-down';
  img.dataset.aosDelay = i * 100;
  img.dataset.aosDuration = 1000;
 })

const pelayananKlinik = document.querySelectorAll('.img-pelayanan');

pelayananKlinik.forEach((pelayanan, i) => {
  pelayanan.dataset.aos = 'zoom-in-up';
  pelayanan.dataset.aosDelay = i * 100;
  pelayanan.dataset.aosDuration = 500;
  })
   
const artikelKlinik = document.querySelectorAll('.card-artikel');
   
artikelKlinik.forEach((artikel, i) => {
  artikel.dataset.aos = 'fade-up';
  artikel.dataset.aosDelay = i * 100;
  artikel.dataset.aosDuration = 800;
 })
    
// AOS Fasilitas
const crdFasilitas = document.querySelectorAll('.crd-fasiltias');
      
crdFasilitas.forEach((crdfas, i) => {
  crdfas.dataset.aos = 'zoom-in-up';
  crdfas.dataset.aosDelay = i * 100;
  crdfas.dataset.aosDuration = 800;
  crdfas.dataset.aos.easing = 'ease-in-back';
})

// AOS Spesialisasi
const crdSpesialisasi = document.querySelectorAll('.crd-spesialis');

crdSpesialisasi.forEach((crdSpe, i) => {
  crdSpe.dataset.aos = 'flip-up';
  crdSpe.dataset.aosDelay = i * 400;
  crdSpe.dataset.aosDuration = 800;
})

const mcUmum = document.querySelectorAll('.txt-edukasi p');

mcUmum.forEach((mcU, i) => {
  mcU.dataset.aos = 'fade-up-right';
  mcU.dataset.aosDelay = 600;
  mcU.dataset.aosDuration = 500;
})

const mcuGambar = document.querySelectorAll('.gambar-edukasi');

mcuGambar.forEach((mcuG, i) => {
  mcuG.dataset.aos = 'fade-up';
  mcuG.dataset.aosDelay = i * 700;
  mcuG.dataset.aosDuration = 500;
})

// AOS Artikel
const txtArtikel = document.querySelectorAll('.txt-artikel-lanjutan');

txtArtikel.forEach((txtA, i) => {
  txtA.dataset.aos = 'fade-up';
  txtA.dataset.aosDelay = i * 100;
  txtA.dataset.aosDuration = 800;
})

AOS.init({
  once: true
});

// Toast
var option={
  animation: true,
  delay: 2000
};

const buttonTambah = document.getElementById('btn-tambah')
const toastTampil = document.getElementById('liveToast')
if (buttonTambah) {
  buttonTambah.addEventListener('click', () => {
    const toast = new bootstrap.Toast(toastTampil)
    toast.show()
  })
}


// GSP Index
gsap.from('.img-logo-klinik', { duration: 2.2, y:-100, rotateY: 360, opacity: 0, ease: 'bounce'});
gsap.registerPlugin(TextPlugin);
gsap.from('.cc-index h3', {duration: 1.5, delay: 2, y: '-100%', opacity: 0, ease: 'bounce'});
gsap.from('.cc-index p', {duration: 2.5, delay: 2, text: ''});

//GSP Layanan
gsap.from('.crd-titel', {duration: 1.5, y: '-100%', opacity: 0, ease: 'bounce'});

// GSP Tentang
gsap.from('.logo-hub', {duration: 2.2, rotateY: 360, opacity: 0});

// GSP Artikel
gsap.from('.kolom-artikel h4', {duration: 1.5, x: '100%', opacity: 0, ease: 'back'});

// GSP Apotik
gsap.from('.att-obat', {duration: 3, delay: 3.5,  y: '100%', opacity: 0, ease: 'elastic'});

// GSP Link
gsap.from('.crd-l-a', {duration: 3, delay: 1,  x: '-100%', opacity: 0, ease: 'elastic'});
gsap.from('.crd-l-b', {duration: 3, delay: 1.5,  x: '100%', opacity: 0, ease: 'elastic'});


// Penjelasan Obat
const boxObat = document.querySelector('.crd-penjelasan-obat')
const gambarObat = document.querySelector('.img-penjelasan-obat')
const lens = document.querySelector('.lens')
const result = document.querySelector('.result')

const boxObatRect = boxObat.getBoundingClientRect()
const gambarObatRect = gambarObat.getBoundingClientRect()
const lensRect = lens.getBoundingClientRect()
const resultRect = result.getBoundingClientRect()

boxObat.addEventListener('mousemove', zoomImage)
result.style.backgroundImage = `url(${gambarObat.src})`

function zoomImage(e) {
  console.log('hasil', e.clientX, e.clientY)
  const {x, y} = getMousePos(e)

  lens.style.left = x + 'px'
  lens.style.top = y + 'px'

  let fx = resultRect.width / lensRect.width
  let fy = resultRect.height / lensRect.height

  result.style.backgroundSize = `${gambarObatRect.width * fx}px ${gambarObatRect.height * fy}px`

  result.style.backgroundPosition = `-${x * fx}px -${y * fy}px`

}

function getMousePos(e) {

  let x = e.clientX - boxObatRect.left - lensRect.width /2
  let y = e.clientY - boxObatRect.top - lensRect.height /2

  let minX = 0
  let minY = 0
  let maxX = boxObatRect.width - lensRect.width
  let maxY = boxObatRect.height - lensRect.height

  if (x <= minX){
    x = minX
  } else if (x >= maxX){
    x = maxX
  }
  if (y <= minY){
    y = minY
  } else if (y >= maxY){
    y = maxY
  }

  return {x, y}

}


