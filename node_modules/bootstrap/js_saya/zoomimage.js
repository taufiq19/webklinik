const boxObat = document.querySelector('.crd-penjelasan-obat')
const gambarObat = document.querySelector('.img-penjelasan-obat')
const lens = document.querySelector('.lens')
const result = document.querySelector('.result')

const boxObatRect = boxObat.getBoundingClientRect()
const gambarObatRect = gambarObat.getBoundingClientRect()
const lensRect = lens.getBoundingClientRect()
const resultRect = result.getBoundingClientRect()

boxObat.addEventListener('mousemove', zoomImage)
result.style.backgroundImage = `url(${gambarObat.src})`

function zoomImage(e) {
  console.log('hasil', e.clientX, e.clientY)
  const {x, y} = getMousePos(e)

  lens.style.left = x + 'px'
  lens.style.top = y + 'px'

  let fx = resultRect.width / lensRect.width
  let fy = resultRect.height / lensRect.height

  result.style.backgroundSize = `${gambarObatRect.width * fx}px ${gambarObatRect.height * fy}px`

  result.style.backgroundPosition = `-${x * fx}px -${y * fy}px`

}

function getMousePos(e) {

  let x = e.clientX - boxObatRect.left - lensRect.width /2
  let y = e.clientY - boxObatRect.top - lensRect.height /2

  let minX = 0
  let minY = 0
  let maxX = boxObatRect.width - lensRect.width
  let maxY = boxObatRect.height - lensRect.height

  if (x <= minX){
    x = minX
  } else if (x >= maxX){
    x = maxX
  }
  if (y <= minY){
    y = minY
  } else if (y >= maxY){
    y = maxY
  }

  return {x, y}

}